<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>命理预测软件 - 全功能测试</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        header {
            text-align: center;
            padding: 30px;
            color: white;
        }
        header h1 { font-size: 36px; margin-bottom: 10px; }
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .test-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        .test-card h2 {
            color: #333;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }
        .test-result {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            font-family: monospace;
            font-size: 13px;
            line-height: 1.6;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            background: #667eea;
            color: white;
            font-size: 14px;
            cursor: pointer;
            margin-top: 10px;
            transition: all 0.3s;
        }
        .btn:hover {
            background: #764ba2;
            transform: translateY(-2px);
        }
        .pass { color: #4caf50; font-weight: bold; }
        .fail { color: #f44336; font-weight: bold; }
        .info { color: #2196f3; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>命理预测软件 - 全功能测试</h1>
            <p style="opacity: 0.9;">八字 · 紫微 · 六爻 · 奇门</p>
        </header>

        <div class="test-grid">
            <!-- 八字测试 -->
            <div class="test-card">
                <h2>八字命理测试</h2>
                <button class="btn" onclick="testBaZi()">运行测试</button>
                <div id="bazi-result" class="test-result">点击按钮运行测试...</div>
            </div>

            <!-- 紫微斗数测试 -->
            <div class="test-card">
                <h2>紫微斗数测试</h2>
                <button class="btn" onclick="testZiWei()">运行测试</button>
                <div id="ziwei-result" class="test-result">点击按钮运行测试...</div>
            </div>

            <!-- 六爻测试 -->
            <div class="test-card">
                <h2>六爻占卜测试</h2>
                <button class="btn" onclick="testLiuYao()">运行测试</button>
                <div id="liuyao-result" class="test-result">点击按钮运行测试...</div>
            </div>

            <!-- 奇门遁甲测试 -->
            <div class="test-card">
                <h2>奇门遁甲测试</h2>
                <button class="btn" onclick="testQiMen()">运行测试</button>
                <div id="qimen-result" class="test-result">点击按钮运行测试...</div>
            </div>
        </div>
    </div>

    <script>
        // 天干地支数据
        const TIAN_GAN = ['甲', '乙', '丙', '丁', '戊', '己', '庚', '辛', '壬', '癸'];
        const DI_ZHI = ['子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥'];
        const GONG_WEI = ['命宫', '兄弟', '夫妻', '子女', '财帛', '疾厄', '迁移', '仆役', '官禄', '田宅', '福德', '父母'];
        const GONG_ORDER = ['寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥', '子', '丑'];

        // 八字测试
        function testBaZi() {
            const resultDiv = document.getElementById('bazi-result');
            
            // 测试1990年5月15日12时
            const year = 1990;
            const yearGanZhi = TIAN_GAN[(year - 4) % 10] + DI_ZHI[(year - 4) % 12];
            
            let output = '<span class="info">测试日期：1990年5月15日 12时</span>\n\n';
            
            // 年柱
            output += '<span class="pass">✓</span> 年柱计算：\n';
            output += `  1990年 = ${yearGanZhi}年\n`;
            output += `  预期：庚午年\n`;
            output += `  结果：${yearGanZhi === '庚午' ? '<span class="pass">正确</span>' : '<span class="fail">错误</span>'}\n\n`;
            
            // 生肖
            const shengXiao = ['鼠', '牛', '虎', '兔', '龙', '蛇', '马', '羊', '猴', '鸡', '狗', '猪'];
            const animal = shengXiao[(year - 4) % 12];
            output += '<span class="pass">✓</span> 生肖计算：\n';
            output += `  1990年生肖 = ${animal}\n`;
            output += `  预期：马\n`;
            output += `  结果：${animal === '马' ? '<span class="pass">正确</span>' : '<span class="fail">错误</span>'}\n\n`;
            
            // 日柱计算
            const baseDate = new Date(1900, 0, 1);
            const testDate = new Date(1990, 4, 15);
            const diffDays = Math.floor((testDate - baseDate) / (24 * 60 * 60 * 1000));
            const dayGan = TIAN_GAN[(0 + diffDays) % 10];
            const dayZhi = DI_ZHI[(10 + diffDays) % 12];
            
            output += '<span class="pass">✓</span> 日柱计算：\n';
            output += `  1990年5月15日 = ${dayGan}${dayZhi}日\n`;
            output += `  天数差：${diffDays}天\n`;
            
            resultDiv.innerHTML = output;
        }

        // 紫微斗数测试
        function testZiWei() {
            const resultDiv = document.getElementById('ziwei-result');
            
            // 测试参数
            const lunarMonth = 5;
            const hour = 12;
            
            // 计算命宫
            const monthIndex = lunarMonth - 1;
            const hourIndex = Math.floor((hour + 1) / 2) % 12;
            const mingGongIndex = (monthIndex + hourIndex) % 12;
            
            let output = '<span class="info">测试参数：农历5月 12时</span>\n\n';
            
            output += '<span class="pass">✓</span> 命宫计算：\n';
            output += `  月份索引：${monthIndex} (5月)\n`;
            output += `  时辰索引：${hourIndex} (午时)\n`;
            output += `  命宫位置：${mingGongIndex} (${GONG_ORDER[mingGongIndex]}宫)\n`;
            output += `  对应宫位：${GONG_WEI[mingGongIndex]}\n\n`;
            
            // 计算身宫
            const shenGongIndex = (monthIndex - hourIndex + 12) % 12;
            output += '<span class="pass">✓</span> 身宫计算：\n';
            output += `  身宫位置：${shenGongIndex} (${GONG_ORDER[shenGongIndex]}宫)\n`;
            output += `  对应宫位：${GONG_WEI[shenGongIndex]}\n\n`;
            
            output += '<span class="info">十二宫顺序：</span>\n';
            GONG_ORDER.forEach((zhi, i) => {
                const gongName = GONG_WEI[(i - mingGongIndex + 12) % 12];
                const isMing = i === mingGongIndex ? ' ← 命宫' : '';
                const isShen = i === shenGongIndex ? ' ← 身宫' : '';
                output += `  ${zhi}宫：${gongName}${isMing}${isShen}\n`;
            });
            
            resultDiv.innerHTML = output;
        }

        // 六爻测试
        function testLiuYao() {
            const resultDiv = document.getElementById('liuyao-result');
            
            // 时间起卦测试
            const year = 2024;
            const month = 2;
            const day = 17;
            const hour = 12;
            
            const shangGuaNum = (year + month + day) % 8 || 8;
            const xiaGuaNum = (year + month + day + hour) % 8 || 8;
            const dongYaoNum = (year + month + day + hour) % 6 || 6;
            
            const baGua = ['乾', '兑', '离', '震', '巽', '坎', '艮', '坤'];
            
            let output = '<span class="info">时间起卦测试</span>\n';
            output += `日期：${year}年${month}月${day}日 ${hour}时\n\n`;
            
            output += '<span class="pass">✓</span> 起卦计算：\n';
            output += `  上卦：(${year} + ${month} + ${day}) % 8 = ${shangGuaNum} → ${baGua[shangGuaNum - 1]}卦\n`;
            output += `  下卦：(${year} + ${month} + ${day} + ${hour}) % 8 = ${xiaGuaNum} → ${baGua[xiaGuaNum - 1]}卦\n`;
            output += `  动爻：(${year} + ${month} + ${day} + ${hour}) % 6 = ${dongYaoNum} → ${dongYaoNum}爻动\n\n`;
            
            output += '<span class="pass">✓</span> 卦象组合：\n';
            output += `  本卦：${baGua[shangGuaNum - 1]}上${baGua[xiaGuaNum - 1]}下\n`;
            output += `  动爻位置：第${dongYaoNum}爻\n\n`;
            
            // 世爻应爻
            const shiYao = dongYaoNum - 1;
            const yingYao = (shiYao + 3) % 6;
            output += '<span class="pass">✓</span> 世应定位：\n';
            output += `  世爻：第${shiYao + 1}爻 (代表自己)\n`;
            output += `  应爻：第${yingYao + 1}爻 (代表对方)\n`;
            
            resultDiv.innerHTML = output;
        }

        // 奇门遁甲测试
        function testQiMen() {
            const resultDiv = document.getElementById('qimen-result');
            
            const year = 2024;
            const month = 2;
            const day = 17;
            const hour = 12;
            
            const monthDay = month * 100 + day;
            const isYang = monthDay >= 1222 || monthDay < 622;
            const juShu = (year + month + day) % 9 || 9;
            
            let output = '<span class="info">奇门遁甲排盘测试</span>\n';
            output += `日期：${year}年${month}月${day}日 ${hour}时\n\n`;
            
            output += '<span class="pass">✓</span> 局数判定：\n';
            output += `  日期：${month}月${day}日 (${monthDay})\n`;
            output += `  阴阳：${isYang ? '阳遁 (冬至后)' : '阴遁 (夏至后)'}\n`;
            output += `  局数：${juShu}局\n\n`;
            
            // 九宫格
            const jiuGong = [
                { p: 4, n: '巽', d: '东南' },
                { p: 9, n: '离', d: '南' },
                { p: 2, n: '坤', d: '西南' },
                { p: 3, n: '震', d: '东' },
                { p: 5, n: '中', d: '中央' },
                { p: 7, n: '兑', d: '西' },
                { p: 8, n: '艮', d: '东北' },
                { p: 1, n: '坎', d: '北' },
                { p: 6, n: '乾', d: '西北' }
            ];
            
            output += '<span class="pass">✓</span> 九宫格方位：\n';
            output += `  ${jiuGong[0].n}(${jiuGong[0].d})  ${jiuGong[1].n}(${jiuGong[1].d})  ${jiuGong[2].n}(${jiuGong[2].d})\n`;
            output += `  ${jiuGong[3].n}(${jiuGong[3].d})  ${jiuGong[4].n}(${jiuGong[4].d})  ${jiuGong[5].n}(${jiuGong[5].d})\n`;
            output += `  ${jiuGong[6].n}(${jiuGong[6].d})  ${jiuGong[7].n}(${jiuGong[7].d})  ${jiuGong[8].n}(${jiuGong[8].d})\n\n`;
            
            // 八门
            const baMen = ['休门', '生门', '伤门', '杜门', '景门', '死门', '惊门', '开门'];
            const menStart = hour % 8;
            output += '<span class="pass">✓</span> 八门排布（示例）：\n';
            for (let i = 0; i < 8; i++) {
                const menIndex = (menStart + i) % 8;
                output += `  ${baMen[menIndex]} `;
            }
            output += '\n\n<span class="info">注：以上为简化算法演示，实际排盘更复杂</span>';
            
            resultDiv.innerHTML = output;
        }

        // 页面加载后自动运行所有测试
        window.onload = function() {
            setTimeout(() => {
                testBaZi();
                testZiWei();
                testLiuYao();
                testQiMen();
            }, 500);
        };
    </script>
</body>
</html>
